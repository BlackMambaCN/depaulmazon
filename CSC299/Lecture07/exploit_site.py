import mechanize


br = mechanize.Browser()
br.set_handle_robots(False)
br.addheaders = [('User-agent','Firefox')]

def register(first_name, 
             last_name, 
             email,
             password):
    response = br.open('http://mdp.cdm.depaul.edu/csc438blog/default/user/register')

    br.select_form(nr=0)
    br.form[ 'first_name' ] = first_name
    br.form[ 'last_name' ] = last_name
    br.form[ 'email' ] = email
    br.form[ 'password' ] = password
    br.form[ 'password_two' ] = password
    br.submit()
    response = br.response()
    print response.read()


def login(email, password):
    response = br.open('http://mdp.cdm.depaul.edu/csc438blog/default/user/login')

    br.select_form(nr=0)
    br.form[ 'email' ] = email
    br.form[ 'password' ] = password
    br.submit()
    response = br.response()
    print response.read()

def post_random_comment(url, body="Doh!"):
    response = br.open(url)

    br.select_form(nr=0)
    br.form[ 'body' ] = body
    br.submit()
    response = br.response()
    print response.read()    

#register('Homer','Simpson','homer@example.com',
#         'doh!')

login('homer@example.com','doh!')
for k in range(10):
    post_random_comment('http://mdp.cdm.depaul.edu/csc438blog/default/show/1', body='Doh! (%i)' % k)
